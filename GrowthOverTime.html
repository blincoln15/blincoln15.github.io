<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="style.css">
  <title>Crop Yield Comparison</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<ul>
  <li><a href="index.html">Home</a></li>
  <li><a class="active" href="GrowthOverTime.html">Growth Over Time</a></li>
  <li><a href="GlobalGrowth.html">Global Growth</a></li>  
  <li style="float:right"><a href="#about">About</a></li>
</ul>
<body>

    <div id="line-chart" style="width: 80%; height: 600px; margin: 0 auto;"></div>

    <script>
        // Function to load CSV data and return parsed results
        function loadCSV(filePath, callback) {
            Papa.parse(filePath, {
                download: true,
                header: true,
                dynamicTyping: true,
                complete: function(results) {
                    callback(results.data);
                }
            });
        }

        // Data arrays to store crop yield data
        let maizeData = [], soybeanData = [], wheatData = [], riceData = [];

        // Load all CSV files and prepare the data
        loadCSV('maize_by_year.csv', function(data) {
            maizeData = data.map(row => ({ year: row.year, yield: row.summed_var }));
            loadCSV('soybean_by_year.csv', function(data) {
                soybeanData = data.map(row => ({ year: row.year, yield: row.summed_var }));
                loadCSV('wheat_by_year.csv', function(data) {
                    wheatData = data.map(row => ({ year: row.year, yield: row.summed_var }));
                    loadCSV('rice_by_year.csv', function(data) {
                        riceData = data.map(row => ({ year: row.year, yield: row.summed_var }));

                        // After all CSV files are loaded, plot the chart
                        plotChart();
                    });
                });
            });
        });

        // Function to plot the line chart using Plotly
        function plotChart() {
            const traceMaize = {
                x: maizeData.map(item => item.year),
                y: maizeData.map(item => item.yield),
                mode: 'lines+markers',
                name: 'Maize',
                line: { color: 'green' }
            };

            const traceSoybean = {
                x: soybeanData.map(item => item.year),
                y: soybeanData.map(item => item.yield),
                mode: 'lines+markers',
                name: 'Soybean',
                line: { color: 'blue' }
            };

            const traceWheat = {
                x: wheatData.map(item => item.year),
                y: wheatData.map(item => item.yield),
                mode: 'lines+markers',
                name: 'Wheat',
                line: { color: 'gold' }
            };

            const traceRice = {
                x: riceData.map(item => item.year),
                y: riceData.map(item => item.yield),
                mode: 'lines+markers',
                name: 'Rice',
                line: { color: 'red' }
            };

            const layout = {
                title: 'Crop Yield Comparison (Tonnes per Hectare)',
                xaxis: {
                    title: 'Year',
                    showgrid: false,
                },
                yaxis: {
                    title: 'Tonnes per Hectare',
                    showgrid: true,
                },
                showlegend: true
            };

            const data = [traceMaize, traceSoybean, traceWheat, traceRice];

            Plotly.newPlot('line-chart', data, layout);
        }
    </script>
</body>
</html>
